import{j as s}from"./vendor-query-4MbTBVa_.js";import{r as e,u as a}from"./vendor-react-BPpqjFzU.js";import{o as r,s as l,u as i,a as n,F as c,b as o,c as t,d,e as m,f as x}from"./forms-5XcXeON8.js";import{u,H as j,C as h,b as p,d as f,a as w,a6 as g,a7 as N,a8 as y,a9 as v,I as b,B as P,J as S,aa as E,ab as I}from"./admin-D-5katVs.js";import{aJ as A,a0 as C,a5 as k}from"./vendor-ui-DhEHJaaJ.js";const _=r({email:l().email("Invalid email address"),password:l().min(6,"Password must be at least 6 characters")}),D=r({fullName:l().min(2,"Full name must be at least 2 characters"),email:l().email("Invalid email address"),password:l().min(6,"Password must be at least 6 characters"),confirmPassword:l().min(6,"Password confirmation is required")}).refine(s=>s.password===s.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),F=()=>{const[r,l]=e.useState(!1),F=a(),{toast:J}=u(),V=i({resolver:n(_),defaultValues:{email:"",password:""}}),q=i({resolver:n(D),defaultValues:{fullName:"",email:"",password:"",confirmPassword:""}});e.useEffect(()=>{localStorage.getItem("auth_token")&&F("/")},[F]);return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(j,{}),s.jsx("main",{className:"container mx-auto px-4 py-12",children:s.jsx("div",{className:"max-w-md mx-auto",children:s.jsxs(h,{className:"shadow-lg",children:[s.jsxs(p,{className:"text-center",children:[s.jsx(f,{className:"text-2xl font-bold text-primary",children:"Welcome to Galloways"}),s.jsx("p",{className:"text-muted-foreground",children:"Access your insurance portal"})]}),s.jsx(w,{children:s.jsxs(g,{defaultValue:"signin",className:"w-full",children:[s.jsxs(N,{className:"grid w-full grid-cols-2",children:[s.jsxs(y,{value:"signin",className:"flex items-center gap-2",children:[s.jsx(A,{className:"w-4 h-4"}),"Sign In"]}),s.jsxs(y,{value:"signup",className:"flex items-center gap-2",children:[s.jsx(C,{className:"w-4 h-4"}),"Sign Up"]})]}),s.jsx(v,{value:"signin",className:"mt-6",children:s.jsx(c,{...V,children:s.jsxs("form",{onSubmit:V.handleSubmit(async s=>{var e,a;l(!0);try{const r=await E.login({email:s.email,password:s.password});if(!r.access_token)throw new Error("Authentication failed");I.setToken(r.access_token),J({title:"Success",description:"Signed in successfully!"}),"ADMIN"===(null==(e=r.user)?void 0:e.role)||"SUPER_ADMIN"===(null==(a=r.user)?void 0:a.role)?F("/admin"):F("/")}catch(r){J({title:"Error",description:r.message||"Authentication failed",variant:"destructive"})}finally{l(!1)}}),className:"space-y-4",children:[s.jsx(o,{control:V.control,name:"email",render:({field:e})=>s.jsxs(t,{children:[s.jsx(d,{children:"Email"}),s.jsx(m,{children:s.jsx(b,{type:"email",placeholder:"your.email@example.com",...e})}),s.jsx(x,{})]})}),s.jsx(o,{control:V.control,name:"password",render:({field:e})=>s.jsxs(t,{children:[s.jsx(d,{children:"Password"}),s.jsx(m,{children:s.jsx(b,{type:"password",placeholder:"Enter your password",...e})}),s.jsx(x,{})]})}),s.jsxs(P,{type:"submit",className:"w-full bg-accent hover:bg-accent/90",disabled:r,children:[s.jsx(k,{className:"w-4 h-4 mr-2"}),r?"Signing in...":"Sign In"]})]})})}),s.jsx(v,{value:"signup",className:"mt-6",children:s.jsx(c,{...q,children:s.jsxs("form",{onSubmit:q.handleSubmit(async s=>{l(!0);try{await E.register({fullName:s.fullName,email:s.email,password:s.password}),J({title:"Success",description:"Account created successfully! Please sign in."}),q.reset()}catch(e){J({title:"Error",description:e.message||"Registration failed",variant:"destructive"})}finally{l(!1)}}),className:"space-y-4",children:[s.jsx(o,{control:q.control,name:"fullName",render:({field:e})=>s.jsxs(t,{children:[s.jsx(d,{children:"Full Name"}),s.jsx(m,{children:s.jsx(b,{placeholder:"John Doe",...e})}),s.jsx(x,{})]})}),s.jsx(o,{control:q.control,name:"email",render:({field:e})=>s.jsxs(t,{children:[s.jsx(d,{children:"Email"}),s.jsx(m,{children:s.jsx(b,{type:"email",placeholder:"your.email@example.com",...e})}),s.jsx(x,{})]})}),s.jsx(o,{control:q.control,name:"password",render:({field:e})=>s.jsxs(t,{children:[s.jsx(d,{children:"Password"}),s.jsx(m,{children:s.jsx(b,{type:"password",placeholder:"Create a password",...e})}),s.jsx(x,{})]})}),s.jsx(o,{control:q.control,name:"confirmPassword",render:({field:e})=>s.jsxs(t,{children:[s.jsx(d,{children:"Confirm Password"}),s.jsx(m,{children:s.jsx(b,{type:"password",placeholder:"Confirm your password",...e})}),s.jsx(x,{})]})}),s.jsxs(P,{type:"submit",className:"w-full bg-accent hover:bg-accent/90",disabled:r,children:[s.jsx(C,{className:"w-4 h-4 mr-2"}),r?"Creating account...":"Create Account"]})]})})})]})})]})})}),s.jsx(S,{})]})};export{F as default};
