import{j as e}from"./vendor-query-e7XuV4SY.js";import{c as s,u as a,r as t}from"./vendor-react-CQxzy5md.js";import{H as n,C as l,B as c,F as i}from"./admin-IbDoxUA5.js";import{ax as o,v as r,w as m}from"./vendor-ui-BGFexz3u.js";function d(){const[d]=s(),x=a(),[u,p]=t.useState("loading"),[h,f]=t.useState("Verifying payment..."),j=d.get("reference"),y=d.get("trxref");return t.useEffect(()=>{(async()=>{const e=j||y;if(!e)return p("failed"),void f("Payment reference not found");try{const s="https://api.galloways.co.ke",a=await fetch(`${s}/payments/verify/${e}`,{method:"GET",headers:{Accept:"application/json"}}),t=await a.json();t.success&&"success"===t.status?(p("success"),f("Payment completed successfully! You will receive a confirmation email shortly.")):(p("failed"),f(t.message||"Payment verification failed"))}catch(s){p("failed"),f("Failed to verify payment status")}})()},[j,y]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(n,{}),e.jsx("main",{className:"pt-20 pb-20 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(l,{className:"p-8 text-center",children:["loading"===u&&e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"w-16 h-16 mx-auto mb-4 animate-spin text-primary"}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Verifying Payment"}),e.jsx("p",{className:"text-muted-foreground",children:h})]}),"success"===u&&e.jsxs(e.Fragment,{children:[e.jsx(r,{className:"w-16 h-16 mx-auto mb-4 text-green-500"}),e.jsx("h2",{className:"text-2xl font-bold mb-4 text-green-600",children:"Payment Successful!"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:h}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"w-full",onClick:()=>x("/diaspora"),children:"Back to Diaspora Services"}),e.jsx(c,{variant:"outline",className:"w-full",onClick:()=>{const e=encodeURIComponent(`Hello! I have successfully completed payment with reference: ${j||y}. I would like to schedule my diaspora consultation.`);window.open(`https://wa.me/+254712345678?text=${e}`,"_blank")},children:"Schedule Consultation via WhatsApp"})]})]}),"failed"===u&&e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"w-16 h-16 mx-auto mb-4 text-red-500"}),e.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Payment Failed"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:h}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"w-full",onClick:()=>x("/diaspora"),children:"Try Again"}),e.jsx(c,{variant:"outline",className:"w-full",onClick:()=>{const e=encodeURIComponent("Hello! I'm having trouble with payment for diaspora consultation. Could you please help me?");window.open(`https://wa.me/+254712345678?text=${e}`,"_blank")},children:"Get Help via WhatsApp"})]})]})]})})}),e.jsx(i,{})]})}export{d as default};
